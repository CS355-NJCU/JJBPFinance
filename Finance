// Time Driven EMAIL_SENT
function sendEmail(){
ScriptApp.newTrigger('sendEmail')
      .timeBased()
      .onWeekDay(ScriptApp.WeekDay)
      .atHour(9)
      .create();
      
 var EMAIL_SENT = 'EMAIL_SENT';
 var sheet = SpreadsheetApp.getActiveSpreadsheet().getSheetByName("Message Trigger");;
 var startRow = 2;//First row of data to process
 var numRow = 2; //Number of rows to process
  //Fetch the range of cells A2:B3
 var dataRange = sheet.getRange(startRow,1,numRow,3);
  //Fetch values for each row in the Range.
 var data = dataRange.getValues();
  for(var i = 0; i < data.length; ++i){
    
    var row = data[i];
    var emailAddress = row[0]; //First column
    var message = row[1]; //Second column
    var emailSent = row[2]; // Third Column
    if (emailSent != EMAIL_SENT){ // Prevents sending duplicates
      var subject = 'Sending emails from Spreadsheet';
      MailApp.sendEmail(emailAddress, subject, message);
      sheet.getRange(startRow + i,3).setValue(EMAIL_SENT);
      //make sure the cell is updated right away in case the script is interrupted
      SpreadsheetApp.flush();
    }
  }
}
